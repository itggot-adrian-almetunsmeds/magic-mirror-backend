var scheme = "<%= @scheme %>";
var uri = scheme + window.document.location.host + "/";

function connectWebsocket() {
    const ws = new WebSocket(uri);
    useWebSocket(ws)
}

function useWebSocket(ws) {
    console.log(ws)
    if (ws) {

        ws.onmessage = function (message) {
            console.log(JSON.parse(message.data))
        }

        ws.onopen = function () {
            ws.send('Connected to ws')
        }
        ws.onclose = function () {
            console.log('Disconnected from ws')
            setTimeout(connectWebsocket(), 4000)
        }
    } else {
        setTimeout(connectWebsocket(), 4000)
    }
}

connectWebsocket()